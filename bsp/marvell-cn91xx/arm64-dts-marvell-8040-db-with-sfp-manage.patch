From e12a81fd5b5f5daeedf9bf5e1e90577f98310285 Mon Sep 17 00:00:00 2001
From: Yan Markman <ymarkman@marvell.com>
Date: Sun, 5 Aug 2018 12:18:10 +0300
Subject: [PATCH 0508/1051] arm64: dts: marvell 8040-db with sfp manage

Fix 10G support with correct phys and sfp manage

Change-Id: I7926fe61f9689b36d69e16e7e4c1e2752bae7206
Signed-off-by: Yan Markman <ymarkman@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/59457
Reviewed-by: Stefan Chulski <stefanc@marvell.com>
Tested-by: Stefan Chulski <stefanc@marvell.com>
[Kevin: The original patch got from Marvell sdk10.0_19.06]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../arm64/boot/dts/marvell/armada-8040-db.dts | 27 ++++++++++++-------
 1 file changed, 17 insertions(+), 10 deletions(-)

diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db.dts b/arch/arm64/boot/dts/marvell/armada-8040-db.dts
index 1bac437369a1..5cf097a4764a 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db.dts
@@ -70,6 +70,15 @@
 		compatible = "usb-nop-xceiv";
 		vcc-supply = <&cp1_reg_usb3_0_vbus>;
 	};
+
+
+	sfp_eth0: sfp-eth0 {
+		compatible = "sff,sfp";
+	};
+
+	sfp_eth1: sfp-eth1 {
+		compatible = "sff,sfp";
+	};
 };
 
 &i2c0 {
@@ -177,11 +186,10 @@
 &cp0_eth0 {
 	status = "okay";
 	phy-mode = "10gbase-kr";
-
-	fixed-link {
-		speed = <10000>;
-		full-duplex;
-	};
+	/* Generic PHY, providing serdes lanes */
+	phys = <&cp0_comphy2 0>;
+	managed = "in-band-status";
+	sfp = <&sfp_eth0>;
 };
 
 &cp0_eth2 {
@@ -308,11 +316,10 @@
 &cp1_eth0 {
 	status = "okay";
 	phy-mode = "10gbase-kr";
-
-	fixed-link {
-		speed = <10000>;
-		full-duplex;
-	};
+	/* Generic PHY, providing serdes lanes */
+	phys = <&cp1_comphy2 0>;
+	managed = "in-band-status";
+	sfp = <&sfp_eth1>;
 };
 
 &cp1_eth1 {
-- 
2.17.1

