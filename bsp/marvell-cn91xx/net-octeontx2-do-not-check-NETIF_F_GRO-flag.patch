From fbd7df1095a39b2dcce363357dd8a921290e1f16 Mon Sep 17 00:00:00 2001
From: Tomasz Duszynski <tomasz.duszynski@cavium.com>
Date: Thu, 30 Aug 2018 10:07:17 +0200
Subject: [PATCH 0179/1051] net: octeontx2: do not check NETIF_F_GRO flag

napi_gro_receive() checks dev->features for NETIF_F_GRO internally.
If flag is set then GRO handling continues normally. Otherwise
dev_gro_receive() returns GRO_NORMAL and napi_skb_finish()
ends up doing netif_receive_skb_internal(). So eventually
we end up following the same path as in case of netif_receive_skb().

Signed-off-by: Tomasz Duszynski <tduszynski@marvell.com>
[Kevin: The original patch got from Marvell sdk10.0_19.06]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/marvell/octeontx2/otx2_txrx.c | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)

diff --git a/drivers/net/ethernet/marvell/octeontx2/otx2_txrx.c b/drivers/net/ethernet/marvell/octeontx2/otx2_txrx.c
index 4bce1634071d..c3ea30bee3e9 100644
--- a/drivers/net/ethernet/marvell/octeontx2/otx2_txrx.c
+++ b/drivers/net/ethernet/marvell/octeontx2/otx2_txrx.c
@@ -254,10 +254,7 @@ static void otx2_rcv_pkt_handler(struct otx2_nic *pfvf,
 	if (pfvf->netdev->features & NETIF_F_RXCSUM)
 		skb->ip_summed = CHECKSUM_UNNECESSARY;
 
-	if (pfvf->netdev->features & NETIF_F_GRO)
-		napi_gro_receive(&qset->napi[cq->cint_idx].napi, skb);
-	else
-		netif_receive_skb(skb);
+	napi_gro_receive(&qset->napi[cq->cint_idx].napi, skb);
 }
 
 #define CQE_ADDR(CQ, idx) ((CQ)->cqe_base + ((CQ)->cqe_size * (idx)))
-- 
2.17.1

