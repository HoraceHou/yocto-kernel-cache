From 6fbeef08615647bb71fecbe08486526fbf75383d Mon Sep 17 00:00:00 2001
From: Angela Czubak <aczubak@caviumnetworks.com>
Date: Fri, 19 Oct 2018 10:06:05 +0300
Subject: [PATCH 0332/1051] octeontx-pki: add QPG allocation and freeing API

New MBOX messages have been added:
- MBOX_PKI_PORT_ALLOC_QPG
- MBOX_PKI_PORT_FREE_QPG
Their purpose is to allocate/free QPG entries dynamically on per port
basis. These messages use struct mbox_pki_port_qpg_attr, which field,
qpg_base, is modified during allocation and is to be verified during
freeing.

Signed-off-by: Angela Czubak <aczubak@caviumnetworks.com>
Signed-off-by: Yury Norov <ynorov@marvell.com>
Signed-off-by: Yury Norov <ynorov@caviumnetworks.com>
[Kevin: The original patch got from Marvell sdk10.0_19.06]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../net/ethernet/cavium/octeontx-83xx/octeontx_mbox.h    | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/drivers/net/ethernet/cavium/octeontx-83xx/octeontx_mbox.h b/drivers/net/ethernet/cavium/octeontx-83xx/octeontx_mbox.h
index b79ee9985d27..e09f5af7247e 100644
--- a/drivers/net/ethernet/cavium/octeontx-83xx/octeontx_mbox.h
+++ b/drivers/net/ethernet/cavium/octeontx-83xx/octeontx_mbox.h
@@ -591,6 +591,8 @@ struct __attribute__((__packed__)) mbox_tim_ring_conf {
 #define MBOX_PKI_PORT_RESET_STATS		18
 #define MBOX_PKI_GET_PORT_CONFIG		19
 #define MBOX_PKI_GET_PORT_QOS_CONFIG		20
+#define MBOX_PKI_PORT_ALLOC_QPG			21
+#define MBOX_PKI_PORT_FREE_QPG			22
 
 /* pki pkind parse mode */
 enum  {
@@ -606,6 +608,13 @@ typedef struct mbox_pki_port_type {
 	u8 port_type;
 } mbox_pki_port_t;
 
+/* pki port qpg config */
+struct mbox_pki_port_qpg_attr {
+	u8 port_type; /* [in] port type, lbk or bgx */
+	u32 qpg_base; /* [out/in] QPG base that was allocated to the port */
+	u32 qpg_num;  /* [in] number of QPG entries to allocate/free */
+};
+
 /* pki port config */
 typedef struct mbox_pki_port_cfg {
 	u8 port_type;
-- 
2.17.1

