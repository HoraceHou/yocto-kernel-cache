From a40f0a53b2c595001571f48484eea5aa3bfd2247 Mon Sep 17 00:00:00 2001
From: Daniel Baluta <daniel.baluta@nxp.com>
Date: Wed, 28 Feb 2018 14:59:12 +0200
Subject: [PATCH 3379/5242] MLK-15071: ASoC: fsl: imx-ak5558: Fix clk for
 384KHz and 786KHz

commit  6e8159b62150720854e8da520942281784dca21a from
https://source.codeaurora.org/external/imx/linux-imx.git

With the current multipliers SAI isn't able to derive a correct bitclk.

e.g: When recording at 786Khz with current multiplier

MCLK = 24576000, requested freq 24576000 but SAI wants:
MCLK = (DIV + 1) * 2 * freq [SAI TCR2], so an acceptable solution
is to add a 2x factor to mclk.

Reviewed-by: Viorel Suman <viorel.suman@nxp.com>
Signed-off-by: Daniel Baluta <daniel.baluta@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 sound/soc/fsl/imx-ak5558.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/sound/soc/fsl/imx-ak5558.c b/sound/soc/fsl/imx-ak5558.c
index eb6f505..36b31f5 100644
--- a/sound/soc/fsl/imx-ak5558.c
+++ b/sound/soc/fsl/imx-ak5558.c
@@ -53,8 +53,8 @@ struct imx_ak5558_fs_mul {
 	{ .min = 48000,  .max = 48000,  .mul = 512  },
 	{ .min = 96000,  .max = 96000,  .mul = 256  },
 	{ .min = 192000, .max = 192000, .mul = 128  },
-	{ .min = 384000, .max = 384000, .mul = 64  },
-	{ .min = 768000, .max = 768000, .mul = 32   },
+	{ .min = 384000, .max = 384000, .mul = 2 * 64 },
+	{ .min = 768000, .max = 768000, .mul = 2 * 32 },
 };
 
 static struct snd_soc_dapm_widget imx_ak5558_dapm_widgets[] = {
-- 
1.7.9.5

