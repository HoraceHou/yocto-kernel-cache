From b5cc0b7f68c011830f02351e11e39ccbbd60c182 Mon Sep 17 00:00:00 2001
From: Sandor Yu <Sandor.yu@nxp.com>
Date: Mon, 10 Sep 2018 18:25:09 +0800
Subject: [PATCH 4578/5242] MLK-19518-1: HDP: Set no_edid flag when edid read
 failed

commit  04a2026bf1db23e51df76c58493ee179688b7304 from
https://source.codeaurora.org/external/imx/linux-imx.git

Set no_edid flag when edid read failed.

Signed-off-by: Sandor Yu <Sandor.yu@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/gpu/drm/imx/hdp/imx-hdp.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/imx/hdp/imx-hdp.c b/drivers/gpu/drm/imx/hdp/imx-hdp.c
index da4079f..66ab798 100644
--- a/drivers/gpu/drm/imx/hdp/imx-hdp.c
+++ b/drivers/gpu/drm/imx/hdp/imx-hdp.c
@@ -796,8 +796,9 @@ static int imx_hdp_connector_get_modes(struct drm_connector *connector)
 				drm_edid_to_eld(connector, edid);
 			kfree(edid);
 		} else {
-				dev_dbg(hdp->dev, "failed to get edid, use default video modes\n");
+				dev_info(hdp->dev, "failed to get edid, use default video modes\n");
 				num_modes = imx_hdp_default_video_modes(connector);
+				hdp->no_edid = true;
 		}
 	} else {
 		dev_dbg(hdp->dev, "No EDID function, use default video mode\n");
-- 
1.7.9.5

