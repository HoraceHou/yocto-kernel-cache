From 7b557f11b299f945f8ef260cd95b00926484f24e Mon Sep 17 00:00:00 2001
From: ming_qian <ming.qian@nxp.com>
Date: Thu, 15 Nov 2018 18:34:17 +0800
Subject: [PATCH 5134/5242] MLK-20303-3:VPU Encoder:sw reset after resume from
 devices mode suspend

commit  4aba3c0368b8a398aad95e11460e045dabdddf74 from
https://source.codeaurora.org/external/imx/linux-imx.git

Signed-off-by: ming_qian <ming.qian@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/mxc/vpu-encoder-b0/vpu_encoder_b0.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/mxc/vpu-encoder-b0/vpu_encoder_b0.c b/drivers/mxc/vpu-encoder-b0/vpu_encoder_b0.c
index 39f9b3f..a869d34 100644
--- a/drivers/mxc/vpu-encoder-b0/vpu_encoder_b0.c
+++ b/drivers/mxc/vpu-encoder-b0/vpu_encoder_b0.c
@@ -4385,7 +4385,7 @@ static int resume_core(struct core_device *core)
 		else
 			reset_vpu_core_dev(core);
 	} else {
-		if (core->snapshot)
+		if (core->snapshot || instance_count)
 			ret = sw_reset_firmware(core, 1);
 	}
 
-- 
1.7.9.5

