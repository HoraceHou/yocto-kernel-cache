From 1e76c5f29329068adc99537899765fec07a4a9b7 Mon Sep 17 00:00:00 2001
From: Fancy Fang <chen.fang@freescale.com>
Date: Fri, 14 Aug 2015 14:28:31 +0800
Subject: [PATCH 0209/5242] MLK-11362 video: mxsfb: add busfreq support for
 this module

commit  ea3b271168031acb62a5782a2e11264e4dd2c48e from
https://source.codeaurora.org/external/imx/linux-imx.git

Add busfreq support for this framebuffer driver.

Signed-off-by: Fancy Fang <chen.fang@freescale.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/video/fbdev/mxsfb.c |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/video/fbdev/mxsfb.c b/drivers/video/fbdev/mxsfb.c
index ef97ad3..f799b0a 100644
--- a/drivers/video/fbdev/mxsfb.c
+++ b/drivers/video/fbdev/mxsfb.c
@@ -39,6 +39,7 @@
  * the required value in the imx_fb_videomode structure.
  */
 
+#include <linux/busfreq-imx.h>
 #include <linux/console.h>
 #include <linux/module.h>
 #include <linux/kernel.h>
@@ -1537,6 +1538,7 @@ static void mxsfb_shutdown(struct platform_device *pdev)
 #ifdef CONFIG_PM_RUNTIME
 static int mxsfb_runtime_suspend(struct device *dev)
 {
+	release_bus_freq(BUS_FREQ_HIGH);
 	dev_dbg(dev, "mxsfb busfreq high release.\n");
 
 	return 0;
@@ -1544,6 +1546,7 @@ static int mxsfb_runtime_suspend(struct device *dev)
 
 static int mxsfb_runtime_resume(struct device *dev)
 {
+	request_bus_freq(BUS_FREQ_HIGH);
 	dev_dbg(dev, "mxsfb busfreq high request.\n");
 
 	return 0;
-- 
1.7.9.5

