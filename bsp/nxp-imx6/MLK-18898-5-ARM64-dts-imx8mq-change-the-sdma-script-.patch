From 06b2fb5580430a2215119d61f94ecb5d7d9cb095 Mon Sep 17 00:00:00 2001
From: Viorel Suman <viorel.suman@nxp.com>
Date: Mon, 27 Aug 2018 14:40:45 +0300
Subject: [PATCH 4455/5242] MLK-18898-5: ARM64: dts: imx8mq: change the sdma
 script for SAI
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

commit  9c8a4435be9a341a419dabc0755de0f949f2d86d from
https://source.codeaurora.org/external/imx/linux-imx.git

The IMX_DMATYPE_SAI(24) performance is not enough to support high
sample rate/channels of audio case, there is a lot of underrun and
the sound is noise, the reason is that with this script, sdma copy data
through a long path (SDMA->pl301_audio -> pl301_display -> â€¦ ->
pl301_wakeup -> AIPS1 -> SPBA2 -> SAI).

The IMX_DMATYPE_SSI_SP(2) performance is better, which go through a shorter
path (SDMA -> SPBA2 -> SAI).

So we switch to use the IMX_DMATYPE_SSI_SP script, then 384k/32b/16c is
supported well.

Cloned from commit d5b70e923221 ("MLK-18643: ARM64: dts: imx8mm: change the
sdma script for SAI").

Signed-off-by: Shengjiu Wang <shengjiu.wang@nxp.com>
Signed-off-by: Viorel Suman <viorel.suman@nxp.com>
(cherry picked from commit 390620091748db98216c2f95fe95fb4ac3284564)
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi b/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
index dd287c4..4c5d9dc 100755
--- a/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8mq.dtsi
@@ -1041,7 +1041,7 @@
 			<&clk IMX8MQ_CLK_SAI1_ROOT>,
 			<&clk IMX8MQ_CLK_DUMMY>, <&clk IMX8MQ_CLK_DUMMY>;
 		clock-names = "bus", "mclk0", "mclk1", "mclk2", "mclk3";
-		dmas = <&sdma2 8 24 0>, <&sdma2 9 24 0>;
+		dmas = <&sdma2 8 2 0>, <&sdma2 9 2 0>;
 		dma-names = "rx", "tx";
 		fsl,dataline = <0xff 0xff>;
 		status = "disabled";
-- 
1.7.9.5

