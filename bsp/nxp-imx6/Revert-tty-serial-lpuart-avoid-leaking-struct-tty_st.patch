From 757fa1082113a819133e158e90298b94b3bce2fa Mon Sep 17 00:00:00 2001
From: Jason Liu <jason.hui.liu@nxp.com>
Date: Wed, 24 Oct 2018 14:25:31 +0800
Subject: [PATCH 0001/5242] Revert "tty: serial: lpuart: avoid leaking struct
 tty_struct"

commit  56337a8d2d8fa102d7e3a1f85cb16ab575c20fde from
https://source.codeaurora.org/external/imx/linux-imx.git

This reverts commit 2b7ba104769b4b4c5abe2f6d23284a2aaa495197.
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/tty/serial/fsl_lpuart.c |    3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/drivers/tty/serial/fsl_lpuart.c b/drivers/tty/serial/fsl_lpuart.c
index 50b6746..1a2af99 100644
--- a/drivers/tty/serial/fsl_lpuart.c
+++ b/drivers/tty/serial/fsl_lpuart.c
@@ -979,8 +979,7 @@ static inline int lpuart_start_rx_dma(struct lpuart_port *sport)
 	struct circ_buf *ring = &sport->rx_ring;
 	int ret, nent;
 	int bits, baud;
-	struct tty_port *port = &sport->port.state->port;
-	struct tty_struct *tty = port->tty;
+	struct tty_struct *tty = tty_port_tty_get(&sport->port.state->port);
 	struct ktermios *termios = &tty->termios;
 
 	baud = tty_get_baud_rate(tty);
-- 
1.7.9.5

