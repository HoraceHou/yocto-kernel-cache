From 6e8ccecbac496d9ed1a3db327ffae3fd4d9df553 Mon Sep 17 00:00:00 2001
From: Peng Fan <peng.fan@nxp.com>
Date: Tue, 13 Nov 2018 18:19:01 +0800
Subject: [PATCH 5107/5242] MLK-20349 i2c: xen front: fix build warning

commit  d7aab679caa0a5bb2cb01b71b25e9e5a85b75c4e from
https://source.codeaurora.org/external/imx/linux-imx.git

Fixes build warning introduced by
90e818a0abcc("MLK-20342 i2c: xen-i2cback/front: Add i2c_smbus interface")

Signed-off-by: Peng Fan <peng.fan@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/i2c/busses/xen-i2cfront.c |    5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/i2c/busses/xen-i2cfront.c b/drivers/i2c/busses/xen-i2cfront.c
index c531078..b041415 100644
--- a/drivers/i2c/busses/xen-i2cfront.c
+++ b/drivers/i2c/busses/xen-i2cfront.c
@@ -194,6 +194,7 @@ static int i2cfront_smbus_xfer(struct i2c_adapter *adapter, u16 addr,
 	struct i2cfront_info *info = i2c_get_adapdata(adapter);
 	struct i2cif_response *res;
 	struct i2cif_request *req;
+	unsigned long lock_flags;
 	int more_to_do = 0;
 	RING_IDX i, rp;
 	int notify;
@@ -230,7 +231,7 @@ static int i2cfront_smbus_xfer(struct i2c_adapter *adapter, u16 addr,
 
 	wait_for_completion(&info->completion);
 
-	spin_lock_irqsave(&info->lock, flags);
+	spin_lock_irqsave(&info->lock, lock_flags);
 	rp = info->i2c_ring.sring->rsp_prod;
 	rmb(); /* ensure we see queued responses up to "rp" */
 
@@ -251,7 +252,7 @@ static int i2cfront_smbus_xfer(struct i2c_adapter *adapter, u16 addr,
 	else
 		info->i2c_ring.sring->rsp_event = i + 1;
 
-	spin_unlock_irqrestore(&info->lock, flags);
+	spin_unlock_irqrestore(&info->lock, lock_flags);
 
 	mutex_unlock(&info->xferlock);
 
-- 
1.7.9.5

