From 21f01646f58b8601fd4c38ac30508cdc3d9f9de1 Mon Sep 17 00:00:00 2001
From: Anson Huang <Anson.Huang@nxp.com>
Date: Mon, 10 Sep 2018 09:33:29 +0800
Subject: [PATCH 4561/5242] MLK-19511-1 ARM64: dts: freescale: imx8dx: move
 cm4_intmux early_power_on to board dtb

commit  a4540452f1041cf745d78c03e8889f8236a0d1d4 from
https://source.codeaurora.org/external/imx/linux-imx.git

When early_power_on is present in power domain dtb node, it
will be powered on during resume regardless of whether the
related module is enabled or NOT, this will cause cm4_intmux
always power ON after first time resume when cm4_intmux is
NOT enabled.

So move this early_power_on property to board level dtb, ONLY
when cm4_intmux is enabled, then this property is added.

Signed-off-by: Anson Huang <Anson.Huang@nxp.com>
Reviewed-by: Bai Ping <ping.bai@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-imx8dx.dtsi     |    1 -
 arch/arm64/boot/dts/freescale/fsl-imx8qxp-mek.dts |    4 ++++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8dx.dtsi b/arch/arm64/boot/dts/freescale/fsl-imx8dx.dtsi
index 0473462..d6086c9 100644
--- a/arch/arm64/boot/dts/freescale/fsl-imx8dx.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8dx.dtsi
@@ -1095,7 +1095,6 @@
 				reg = <SC_R_M4_0_INTMUX>;
 				#power-domain-cells = <0>;
 				power-domains =<&pd_cm40>;
-				early_power_on;
 			};
 		};
 
diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8qxp-mek.dts b/arch/arm64/boot/dts/freescale/fsl-imx8qxp-mek.dts
index 6138b6f..805695c 100755
--- a/arch/arm64/boot/dts/freescale/fsl-imx8qxp-mek.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8qxp-mek.dts
@@ -669,6 +669,10 @@
 	};
 };
 
+&pd_cm40_intmux {
+	early_power_on;
+};
+
 &intmux_cm40 {
 	status = "okay";
 };
-- 
1.7.9.5

