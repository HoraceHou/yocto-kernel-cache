From dbda2fba0fdbe299dd872ae1bf55c0bba8a626da Mon Sep 17 00:00:00 2001
From: qwang2 <quanyang.wang@windriver.com>
Date: Fri, 6 Jul 2018 15:56:11 +0800
Subject: [PATCH 2/8] nxp-imx6: add delay workaround to ERR005723

In commit 353d79304619 ("ARM: mx6: Fix suspend/resume with PCI"), it introduces
a workaround for ERR005723. But it is not stable, and need add some delay
between PCI devices resume. So I add mdelay(50) in imx6 pci driver's resume function
as a workaround. This resolution is harmless and only a tiny delay in resume.

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/pci/controller/dwc/pci-imx6.c |    1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/pci/controller/dwc/pci-imx6.c b/drivers/pci/controller/dwc/pci-imx6.c
index 9aae0d7..ec99fbb 100644
--- a/drivers/pci/controller/dwc/pci-imx6.c
+++ b/drivers/pci/controller/dwc/pci-imx6.c
@@ -2136,6 +2136,7 @@ static int pci_imx_resume_noirq(struct device *dev)
 			dev_info(dev, "pcie link is down after resume.\n");
 	}
 
+	mdelay(50);
 	return ret;
 }
 
-- 
1.7.9.5

