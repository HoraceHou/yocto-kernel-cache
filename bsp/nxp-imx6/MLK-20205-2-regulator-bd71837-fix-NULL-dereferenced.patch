From 988e2320ea38c5aade0a1c539bfa3ccbc1d247ca Mon Sep 17 00:00:00 2001
From: Robin Gong <yibin.gong@nxp.com>
Date: Wed, 7 Nov 2018 23:28:17 +0800
Subject: [PATCH 5046/5242] MLK-20205-2: regulator: bd71837: fix NULL
 dereferenced

commit  e4dfaaa9c3add64e10d8a641a2e1a22668403712 from
https://source.codeaurora.org/external/imx/linux-imx.git

Fix 'Explicit null dereferenced' coverity issue(CID-3351937).

Signed-off-by: Robin Gong <yibin.gong@nxp.com>
Reviewed-by: Anson Huang <Anson.Huang@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/regulator/bd71837-regulator.c |    5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/regulator/bd71837-regulator.c b/drivers/regulator/bd71837-regulator.c
index 05ceb6a..0052f02 100644
--- a/drivers/regulator/bd71837-regulator.c
+++ b/drivers/regulator/bd71837-regulator.c
@@ -873,14 +873,15 @@ static int bd71837_probe(struct platform_device *pdev)
 		if (pdata) {
 			init_data = pdata->init_data[i];
 		} else {
-			init_data = matches[i].init_data;
+			init_data = bd71837_matches[i].init_data;
 		}
 
 		config.dev = pmic->dev;
 		config.init_data = init_data;
 		config.driver_data = pmic;
 		config.regmap = bd71837->regmap;
-		config.of_node = matches[i].of_node;
+		if (matches)
+			config.of_node = matches[i].of_node;
 		dev_info(config.dev, "regulator register name '%s'\n", desc->name);
 
 		rdev = regulator_register(desc, &config);
-- 
1.7.9.5

