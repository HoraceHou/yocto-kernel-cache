From 469e187f83fec8b0e7a47dd02bf985fb1df92600 Mon Sep 17 00:00:00 2001
From: Han Xu <han.xu@nxp.com>
Date: Wed, 30 Aug 2017 16:05:11 -0500
Subject: [PATCH 2465/5242] MLK-16330: mtd: fsl-quadspi: remove unnecessary
 variable

commit  8b81574024c1357e416cf69a360a5c65e28d6fee from
https://source.codeaurora.org/external/imx/linux-imx.git

Remove the unnecessary tmp array from code

Signed-off-by: Han Xu <han.xu@nxp.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/mtd/spi-nor/fsl-quadspi.c |    4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/drivers/mtd/spi-nor/fsl-quadspi.c b/drivers/mtd/spi-nor/fsl-quadspi.c
index b733a24..810c063 100644
--- a/drivers/mtd/spi-nor/fsl-quadspi.c
+++ b/drivers/mtd/spi-nor/fsl-quadspi.c
@@ -1006,7 +1006,6 @@ static ssize_t fsl_qspi_read(struct spi_nor *nor, loff_t from,
 {
 	struct fsl_qspi *q = nor->priv;
 	u8 cmd = nor->read_opcode;
-	u8 tmp[8] = {0};
 	int i, j;
 
 	/* if necessary,ioremap buffer before AHB read, */
@@ -1046,10 +1045,9 @@ static ssize_t fsl_qspi_read(struct spi_nor *nor, loff_t from,
 	if (from % 8) {
 		j = 8 - (from & 0x7);
 		for (i = 0; i < j; ++i) {
-			memcpy(tmp + i, q->ahb_addr + q->chip_base_addr + from
+			memcpy(buf + i, q->ahb_addr + q->chip_base_addr + from
 			       - q->memmap_offs + i, 1);
 		}
-		memcpy(buf, tmp, j);
 		memcpy(buf + j, q->ahb_addr + q->chip_base_addr + from
 		       - q->memmap_offs + j, len - j);
 	} else {
-- 
1.7.9.5

