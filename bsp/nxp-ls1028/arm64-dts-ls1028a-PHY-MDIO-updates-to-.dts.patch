From 626509466313856e902d46765767613cbf7e04ca Mon Sep 17 00:00:00 2001
From: Alex Marginean <alexandru.marginean@nxp.com>
Date: Tue, 20 Nov 2018 18:07:08 +0200
Subject: [PATCH 390/706] arm64: dts: ls1028a: PHY/MDIO updates to .dts

Signed-off-by: Alex Marginean <alexandru.marginean@nxp.com>
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 .../boot/dts/freescale/fsl-ls1028a-rdb.dts    | 68 +++++--------------
 .../arm64/boot/dts/freescale/fsl-ls1028a.dtsi | 11 +++
 2 files changed, 27 insertions(+), 52 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1028a-rdb.dts b/arch/arm64/boot/dts/freescale/fsl-ls1028a-rdb.dts
index 104beb00d735..dda99a19e954 100755
--- a/arch/arm64/boot/dts/freescale/fsl-ls1028a-rdb.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1028a-rdb.dts
@@ -244,90 +244,54 @@
 
 &mdio0 {
 	sgmii_phy0: ethernet-phy@2 {
-		compatible = "ethernet-phy-id004d.d074";
 		reg = <0x2>;
 	};
 
 	qsgmii_phy1: ethernet-phy@4 {
-		compatible = "ethernet-phy-id0007.0670";
-		reg = <0x4>;
+		reg = <0x10>;
 	};
 
 	qsgmii_phy2: ethernet-phy@5 {
-		compatible = "ethernet-phy-id0007.0670";
-		reg = <0x5>;
+		reg = <0x11>;
 	};
 
 	qsgmii_phy3: ethernet-phy@6 {
-		compatible = "ethernet-phy-id0007.0670";
-		reg = <0x6>;
+		reg = <0x12>;
 	};
 
 	qsgmii_phy4: ethernet-phy@7 {
-		compatible = "ethernet-phy-id0007.0670";
-		reg = <0x7>;
+		reg = <0x13>;
 	};
 };
 
-&enetc_port0 { /* workaround MDIO issue, normally it's sgmii_phy0 */
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
+&enetc_port0 {
+	phy-handle = <&sgmii_phy0>;
+	phy-connection-type = "sgmii";
 };
 
 &enetc_port1 {
 	status = "disabled";
 };
 
-&enetc_port2 {
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
-};
-
-&enetc_port3 {
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
-};
-
 /* l2switch ports */
-&switch_port0 { /* workaround MDIO issue, normally it's gsgmii_phyX */
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
+&switch_port0 {
+	phy-handle = <&qsgmii_phy1>;
+	phy-connection-type = "qsgmii";
 };
 
 &switch_port1 {
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
+	phy-handle = <&qsgmii_phy2>;
+	phy-connection-type = "qsgmii";
 };
 
 &switch_port2 {
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
+	phy-handle = <&qsgmii_phy3>;
+	phy-connection-type = "qsgmii";
 };
 
 &switch_port3 {
-	phy-connection-type = "internal";
-	fixed-link {
-		speed = <1000>;
-		full-duplex;
-	};
+	phy-handle = <&qsgmii_phy4>;
+	phy-connection-type = "qsgmii";
 };
 
 &edp {
diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1028a.dtsi b/arch/arm64/boot/dts/freescale/fsl-ls1028a.dtsi
index c0eb89a70e9b..913a073da9d0 100755
--- a/arch/arm64/boot/dts/freescale/fsl-ls1028a.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1028a.dtsi
@@ -632,12 +632,18 @@
 			};
 			enetc_port2: pci@0,2 {
 				reg = <0x000200 0 0 0 0>;
+				phy-connection-type = "internal";
+				fixed-link {
+					speed = <1000>;
+					full-duplex;
+				};
 			};
 			mdio0: pci@0,3 {
 				reg = <0x000300 0 0 0 0>;
 				device_type = "mdio";
 				#address-cells = <1>;
 				#size-cells = <0>;
+				little-endian;
 			};
 			pci@0,4 {
 				reg = <0x000400 0 0 0 0>;
@@ -680,6 +686,11 @@
 			};
 			enetc_port3: pci@0,6 {
 				reg = <0x000600 0 0 0 0>;
+				phy-connection-type = "internal";
+				fixed-link {
+					speed = <1000>;
+					full-duplex;
+				};
 			};
 		};
 
-- 
2.17.1

