From ff5cb7fcb4a13fdef29eabb6f4cee37479d9e669 Mon Sep 17 00:00:00 2001
From: Claudiu Manoil <claudiu.manoil@nxp.com>
Date: Wed, 31 Oct 2018 17:20:25 +0200
Subject: [PATCH 456/706] enetc: Drop MAC source pruning

Signed-off-by: Claudiu Manoil <claudiu.manoil@nxp.com>
(cherry picked from commit ef8092a8a232a38d589d3646f767e2c64a996090)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ethernet/freescale/enetc/enetc_hw.h | 1 -
 drivers/net/ethernet/freescale/enetc/enetc_pf.c | 9 ---------
 2 files changed, 10 deletions(-)

diff --git a/drivers/net/ethernet/freescale/enetc/enetc_hw.h b/drivers/net/ethernet/freescale/enetc/enetc_hw.h
index c1bf499c8bcd..f2ca312b1847 100644
--- a/drivers/net/ethernet/freescale/enetc/enetc_hw.h
+++ b/drivers/net/ethernet/freescale/enetc/enetc_hw.h
@@ -170,7 +170,6 @@ enum enetc_bdr_type {TX, RX};
 #define ENETC_PSICFGR0(n)	(0x0940 + (n) * 0xc)  /* n = SI index */
 #define ENETC_PSICFGR0_SET_TXBDR(val)	((val) & 0xff)
 #define ENETC_PSICFGR0_SET_RXBDR(val)	(((val) & 0xff) << 16)
-#define ENETC_PSICFGR0_SPE	BIT(11)
 #define ENETC_PSICFGR0_VTE	BIT(12)
 #define ENETC_PSICFGR0_SIVIE	BIT(14)
 #define ENETC_PSICFGR0_ASE	BIT(15)
diff --git a/drivers/net/ethernet/freescale/enetc/enetc_pf.c b/drivers/net/ethernet/freescale/enetc/enetc_pf.c
index c36a10d6f636..528345ab6e6c 100644
--- a/drivers/net/ethernet/freescale/enetc/enetc_pf.c
+++ b/drivers/net/ethernet/freescale/enetc/enetc_pf.c
@@ -15,11 +15,6 @@ static const char enetc_drv_ver[] = ENETC_DRV_VER_STR;
 #define ENETC_DRV_NAME_STR "ENETC PF driver"
 static const char enetc_drv_name[] = ENETC_DRV_NAME_STR;
 
-/* PF driver params */
-module_param(debug, uint, 0000);
-static uint prune;
-module_param(prune, uint, 0000);
-
 static void enetc_pf_get_primary_mac_addr(struct enetc_hw *hw, int si, u8 *addr)
 {
 	u32 upper = __raw_readl(hw->port + ENETC_PSIPMAR0(si));
@@ -479,8 +474,6 @@ static void enetc_port_si_configure(struct enetc_si *si)
 
 	/* Add default one-time settings for SI0 (PF) */
 	val |= ENETC_PSICFGR0_SIVC(ENETC_VLAN_TYPE_C | ENETC_VLAN_TYPE_S);
-	if (prune)
-		val |= ENETC_PSICFGR0_SPE;
 
 	enetc_port_wr(hw, ENETC_PSICFGR0(0), val);
 
@@ -490,8 +483,6 @@ static void enetc_port_si_configure(struct enetc_si *si)
 	/* Configure the SIs for each available VF */
 	val = ENETC_PSICFGR0_SIVC(ENETC_VLAN_TYPE_C | ENETC_VLAN_TYPE_S);
 	val |= ENETC_PSICFGR0_VTE | ENETC_PSICFGR0_SIVIE;
-	if (prune)
-		val |= ENETC_PSICFGR0_SPE;
 
 	if (num_rings) {
 		num_rings /= pf->total_vfs;
-- 
2.17.1

