From 0517c180d740f0b2c17551cd956ebc3ef8c90f17 Mon Sep 17 00:00:00 2001
From: Catalin Horghidan <catalin.horghidan@nxp.com>
Date: Mon, 17 Dec 2018 11:48:19 +0200
Subject: [PATCH 414/706] felix: move port config in the same function

Signed-off-by: Catalin Horghidan <catalin.horghidan@nxp.com>
(cherry picked from commit 84cbe3c0c0b9385401972ae1090d4b7909e3a5a9)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ethernet/mscc/felix_board.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/net/ethernet/mscc/felix_board.c b/drivers/net/ethernet/mscc/felix_board.c
index 6901312dc474..08c0f1fbbbf0 100644
--- a/drivers/net/ethernet/mscc/felix_board.c
+++ b/drivers/net/ethernet/mscc/felix_board.c
@@ -441,6 +441,10 @@ static int felix_ports_init(struct ocelot *ocelot)
 			felix_register_xmit_handler(ocelot->ports[port], ndev);
 		/* TODO: check if FL phy require phy_start */
 	}
+	/* set port for external CPU frame extraction/injection */
+	ocelot_write(ocelot, QSYS_EXT_CPU_CFG_EXT_CPUQ_MSK_M |
+		     QSYS_EXT_CPU_CFG_EXT_CPU_PORT(FELIX_EXT_CPU_PORT_ID),
+		     QSYS_EXT_CPU_CFG);
 
 	return 0;
 
@@ -535,10 +539,6 @@ static int felix_pci_probe(struct pci_dev *pdev, const struct pci_device_id *id)
 	if (err)
 		goto err_ports_init;
 
-	/* set port for external CPU frame extraction/injection */
-	ocelot_write(ocelot, QSYS_EXT_CPU_CFG_EXT_CPUQ_MSK_M |
-		     QSYS_EXT_CPU_CFG_EXT_CPU_PORT(FELIX_EXT_CPU_PORT_ID),
-		     QSYS_EXT_CPU_CFG);
 	register_netdevice_notifier(&ocelot_netdevice_nb);
 
 	dev_info(&pdev->dev, "%s - version %s probed\n", felix_driver_string,
-- 
2.17.1

