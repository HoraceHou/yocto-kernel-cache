From 49fc6bf74dfc9ab9ba999073cd62b7a78577c65f Mon Sep 17 00:00:00 2001
From: Catalin Horghidan <catalin.horghidan@nxp.com>
Date: Fri, 8 Feb 2019 14:34:46 +0200
Subject: [PATCH 627/706] felix: reset IP and TCP header skb pointers after
 pulling xtr header

Signed-off-by: Catalin Horghidan <catalin.horghidan@nxp.com>
(cherry picked from commit 671017e4a041b91a1435193a28ef4f4021cf8641)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ethernet/mscc/felix_board.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/net/ethernet/mscc/felix_board.c b/drivers/net/ethernet/mscc/felix_board.c
index 9f25c088fc12..9fed70e3c77b 100644
--- a/drivers/net/ethernet/mscc/felix_board.c
+++ b/drivers/net/ethernet/mscc/felix_board.c
@@ -244,6 +244,9 @@ static rx_handler_result_t felix_frm_ext_handler(struct sk_buff **pskb)
 
 	skb->protocol = eth_type_trans(skb, ndev);
 	/* TODO: recompute checksum */
+	skb_reset_transport_header(skb);
+	skb_reset_network_header(skb);
+	skb->pkt_type = PACKET_HOST;
 	skb->ip_summed = CHECKSUM_NONE;
 
 	/* frame for CPU */
-- 
2.17.1

