From 6130e47330c88a23772c4a3fadf6284e1798eeba Mon Sep 17 00:00:00 2001
From: Stefan Chulski <stefanc@marvell.com>
Date: Tue, 7 May 2019 14:58:21 +0300
Subject: [PATCH 215/386] phy: comphy: marvell: add cp110 comphy 2500Base-T
 support

Change-Id: Ib45c4bde5b179b1d8a6fa013cdbb490a4b153e5f
Signed-off-by: Stefan Chulski <stefanc@marvell.com>
Reviewed-on: https://sj1git1.cavium.com/8699
Tested-by: sa_ip-sw-jenkins <sa_ip-sw-jenkins@marvell.com>
Reviewed-by: Marcin Wojtas <marcin@marvell.com>
Reviewed-by: Stefan Chulski <Stefan.Chulski@cavium.com>
[RH: Original patch taken from marvell 88F3720 board support SDK 10.0-PR2003]
Signed-off-by: Ruiqiang Hao <Ruiqiang.Hao@windriver.com>
---
 drivers/phy/marvell/phy-mvebu-cp110-comphy.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/drivers/phy/marvell/phy-mvebu-cp110-comphy.c b/drivers/phy/marvell/phy-mvebu-cp110-comphy.c
index 44a0128a5229..5aeef2005297 100644
--- a/drivers/phy/marvell/phy-mvebu-cp110-comphy.c
+++ b/drivers/phy/marvell/phy-mvebu-cp110-comphy.c
@@ -102,6 +102,7 @@ static const struct mvebu_comhy_conf mvebu_comphy_a3700_modes[] = {
 	/* lane 0 */
 	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF(0, 0, PHY_MODE_USB_HOST),
 	MVEBU_COMPHY_CONF(0, 0, PHY_MODE_USB_DEVICE),
 	/* lane 1 */
@@ -117,17 +118,20 @@ static const struct mvebu_comhy_conf mvebu_comphy_cp110_modes[] = {
 	/* lane 0 */
 	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(0, 1, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF(0, 0, PHY_MODE_PCIE),
 	MVEBU_COMPHY_CONF(0, 1, PHY_MODE_SATA),
 	/* lane 1 */
 	MVEBU_COMPHY_CONF_ETH(1, 2, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(1, 2, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(1, 2, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF(1, 0, PHY_MODE_PCIE),
 	MVEBU_COMPHY_CONF(1, 0, PHY_MODE_SATA),
 	MVEBU_COMPHY_CONF(1, 0, PHY_MODE_USB_HOST),
 	/* lane 2 */
 	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_10GKR),
 	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_5GKR),
 	MVEBU_COMPHY_CONF_ETH(2, 0, PHY_INTERFACE_MODE_INTERNAL),
@@ -138,6 +142,7 @@ static const struct mvebu_comhy_conf mvebu_comphy_cp110_modes[] = {
 	/* lane 3 */
 	MVEBU_COMPHY_CONF_ETH(3, 1, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(3, 1, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(3, 1, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF(3, 0, PHY_MODE_PCIE),
 	MVEBU_COMPHY_CONF(3, 1, PHY_MODE_SATA),
 	MVEBU_COMPHY_CONF(3, 1, PHY_MODE_USB_HOST),
@@ -145,6 +150,7 @@ static const struct mvebu_comhy_conf mvebu_comphy_cp110_modes[] = {
 	/* lane 4 */
 	MVEBU_COMPHY_CONF_ETH(4, 0, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(4, 0, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(4, 0, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF_ETH(4, 0, PHY_INTERFACE_MODE_10GKR),
 	MVEBU_COMPHY_CONF_ETH(4, 1, PHY_INTERFACE_MODE_10GKR),
 	MVEBU_COMPHY_CONF_ETH(4, 0, PHY_INTERFACE_MODE_5GKR),
@@ -157,6 +163,7 @@ static const struct mvebu_comhy_conf mvebu_comphy_cp110_modes[] = {
 	/* lane 5 */
 	MVEBU_COMPHY_CONF_ETH(5, 2, PHY_INTERFACE_MODE_SGMII),
 	MVEBU_COMPHY_CONF_ETH(5, 2, PHY_INTERFACE_MODE_2500BASEX),
+	MVEBU_COMPHY_CONF_ETH(5, 2, PHY_INTERFACE_MODE_2500BASET),
 	MVEBU_COMPHY_CONF(5, 2, PHY_MODE_PCIE),
 	MVEBU_COMPHY_CONF(5, 1, PHY_MODE_SATA),
 	MVEBU_COMPHY_CONF_ETH(5, 0, PHY_INTERFACE_MODE_RXAUI),
@@ -237,6 +244,7 @@ static int mvebu_comphy_eth_power_on(struct phy *phy)
 						      COMPHY_SPEED_1_25G));
 		break;
 	case PHY_INTERFACE_MODE_2500BASEX:
+	case PHY_INTERFACE_MODE_2500BASET:
 		ret = data->comphy_smc(MV_SIP_COMPHY_POWER_ON, priv->phys,
 				 lane->id,
 				 COMPHY_FW_NET_FORMAT(COMPHY_HS_SGMII_MODE,
-- 
2.17.1

