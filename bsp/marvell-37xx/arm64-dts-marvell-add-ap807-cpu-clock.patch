From 87fcb52e8c2c95fbe679336f5795bc9115196799 Mon Sep 17 00:00:00 2001
From: Ben Peled <bpeled@marvell.com>
Date: Sun, 28 Apr 2019 13:54:41 +0300
Subject: [PATCH 183/386] arm64: dts: marvell: add ap807-cpu-clock

Change-Id: I5eeafcdf3ccd3b747507d32a63383d0b78cb0b15
Signed-off-by: Ben Peled <bpeled@marvell.com>
Reviewed-on: https://sj1git1.cavium.com/7826
Tested-by: sa_ip-sw-jenkins <sa_ip-sw-jenkins@marvell.com>
Reviewed-by: Stefan Chulski <Stefan.Chulski@cavium.com>
Reviewed-by: Nadav Haklai <Nadav.Haklai@cavium.com>
[RH: Original patch taken from marvell 88F3720 board support SDK 10.0-PR2003]
Signed-off-by: Ruiqiang Hao <Ruiqiang.Hao@windriver.com>
---
 arch/arm64/boot/dts/marvell/armada-ap807-quad.dtsi |  4 ++++
 arch/arm64/boot/dts/marvell/armada-ap807.dtsi      | 14 ++++++++++++++
 2 files changed, 18 insertions(+)

diff --git a/arch/arm64/boot/dts/marvell/armada-ap807-quad.dtsi b/arch/arm64/boot/dts/marvell/armada-ap807-quad.dtsi
index 8d0664b94eb7..9903cf2beec2 100644
--- a/arch/arm64/boot/dts/marvell/armada-ap807-quad.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-ap807-quad.dtsi
@@ -59,6 +59,7 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x000>;
 			enable-method = "psci";
+			clocks = <&cpu_clk 0>;
 			cpu-idle-states = <&CPU_SLEEP_0>;
 			i-cache-size = <0xc000>;
 			i-cache-line-size = <64>;
@@ -73,6 +74,7 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x001>;
 			enable-method = "psci";
+			clocks = <&cpu_clk 0>;
 			cpu-idle-states = <&CPU_SLEEP_0>;
 			i-cache-size = <0xc000>;
 			i-cache-line-size = <64>;
@@ -87,6 +89,7 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x100>;
 			enable-method = "psci";
+			clocks = <&cpu_clk 1>;
 			cpu-idle-states = <&CPU_SLEEP_0>;
 			i-cache-size = <0xc000>;
 			i-cache-line-size = <64>;
@@ -101,6 +104,7 @@
 			compatible = "arm,cortex-a72", "arm,armv8";
 			reg = <0x101>;
 			enable-method = "psci";
+			clocks = <&cpu_clk 1>;
 			cpu-idle-states = <&CPU_SLEEP_0>;
 			i-cache-size = <0xc000>;
 			i-cache-line-size = <64>;
diff --git a/arch/arm64/boot/dts/marvell/armada-ap807.dtsi b/arch/arm64/boot/dts/marvell/armada-ap807.dtsi
index beb69e5cba74..9a919fa162ee 100644
--- a/arch/arm64/boot/dts/marvell/armada-ap807.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-ap807.dtsi
@@ -51,4 +51,18 @@
 
 / {
 	model = "Marvell Armada AP807";
+	AP_NAME {
+		config-space@f0000000 {
+			ap_syscon1:system-controller@6f8000 {
+				compatible = "syscon", "simple-mfd";
+				reg = <0x6f8000 0x1000>;
+
+				cpu_clk: clock-cpu {
+					compatible = "marvell,ap807-cpu-clock";
+					clocks = <&ap_clk 0>, <&ap_clk 1>;
+					#clock-cells = <1>;
+				};
+			};
+		};
+	};
 };
-- 
2.17.1

