From 371dc9eb5af5f1c8978015acdda7b0bab03b5315 Mon Sep 17 00:00:00 2001
From: Catalin Enache <catalin.enache@windriver.com>
Date: Thu, 10 Jan 2019 10:31:43 +0200
Subject: [PATCH] usb: common: otg-fsm: fix __usb_get_extra_descriptor
 compilation error

usb-otg-fsm.c:172:4: error: too few arguments to function '__usb_get_extra_descriptor'
|    (__usb_get_extra_descriptor(udev->rawdescriptors[0],
|     ^~~~~~~~~~~~~~~~~~~~~~~~~~

This issue specific to nxp-imx7 kernel tree.

Fixes: LIN10-5158 ("Security Advisory - linux - CVE-2018-20169")
Issue: LIN10-5287
Signed-off-by: Catalin Enache <catalin.enache@windriver.com>
---
 drivers/usb/common/usb-otg-fsm.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/usb/common/usb-otg-fsm.c b/drivers/usb/common/usb-otg-fsm.c
index 1476c10..f5d0e2d 100644
--- a/drivers/usb/common/usb-otg-fsm.c
+++ b/drivers/usb/common/usb-otg-fsm.c
@@ -171,7 +171,7 @@ static void otg_hnp_polling_work(struct work_struct *work)
 	if (fsm->tst_maint &&
 		(__usb_get_extra_descriptor(udev->rawdescriptors[0],
 		le16_to_cpu(udev->config[0].desc.wTotalLength),
-				USB_DT_OTG, (void **) &desc) == 0)) {
+				USB_DT_OTG, (void **) &desc, sizeof(*desc)) == 0)) {
 		/* shorter bLength of OTG 1.3 or earlier */
 		if (desc->bLength < 5) {
 			fsm->a_bus_req = 0;
-- 
1.7.9.5

