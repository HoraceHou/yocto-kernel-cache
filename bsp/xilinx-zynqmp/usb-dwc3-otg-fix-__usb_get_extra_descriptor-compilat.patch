From 3c57af16c2d86734f1fa1282e19dcc4edde75b8e Mon Sep 17 00:00:00 2001
From: Catalin Enache <catalin.enache@windriver.com>
Date: Thu, 10 Jan 2019 10:41:24 +0200
Subject: [PATCH] usb: dwc3: otg: fix __usb_get_extra_descriptor compilation
 error

dwc3/otg.c:440:7: error: too few arguments to function '__usb_get_extra_descriptor'
|    if (__usb_get_extra_descriptor(udev->rawdescriptors[0],
|        ^~~~~~~~~~~~~~~~~~~~~~~~~~

This issue specific to xilinx-zynqmp kernel tree.

Fixes: LIN10-5158 ("Security Advisory - linux - CVE-2018-20169")
Issue: LIN10-5287
Signed-off-by: Catalin Enache <catalin.enache@windriver.com>
---
 drivers/usb/dwc3/otg.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/usb/dwc3/otg.c b/drivers/usb/dwc3/otg.c
index a5beeed..6ff5c9d 100644
--- a/drivers/usb/dwc3/otg.c
+++ b/drivers/usb/dwc3/otg.c
@@ -439,7 +439,7 @@ int dwc3_otg_host_release(struct usb_hcd *hcd)
 
 		if (__usb_get_extra_descriptor(udev->rawdescriptors[0],
 				le16_to_cpu(udev->config[0].desc.wTotalLength),
-				USB_DT_OTG, (void **) &desc) == 0) {
+				USB_DT_OTG, (void **) &desc, sizeof(*desc)) == 0) {
 			int err;
 
 			dev_info(&udev->dev, "found OTG descriptor\n");
@@ -1648,7 +1648,7 @@ static int dwc3_otg_notify_connect(struct usb_phy *phy,
 		/* descriptor may appear anywhere in config */
 		err = __usb_get_extra_descriptor(udev->rawdescriptors[0],
 				le16_to_cpu(udev->config[0].desc.wTotalLength),
-				USB_DT_OTG, (void **) &desc);
+				USB_DT_OTG, (void **) &desc, sizeof(*desc));
 		if (err || !(desc->bmAttributes & USB_OTG_HNP))
 			return 0;
 
-- 
1.7.9.5

