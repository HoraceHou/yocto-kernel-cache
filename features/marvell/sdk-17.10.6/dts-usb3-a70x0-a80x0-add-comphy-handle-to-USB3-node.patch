From 0ea38e186e8c6108072b83ea4fb7fe78a4ffac93 Mon Sep 17 00:00:00 2001
From: Evan Wang <xswang@marvell.com>
Date: Wed, 14 Jun 2017 13:18:33 +0800
Subject: [PATCH 1195/1345] dts: usb3: a70x0: a80x0: add comphy handle to USB3
 node

commit  4f5d575e0790371240ed26cd24c3ba6314a9c0ff from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

Change-Id: I67eea14f7badfd7930cd6fc232cc90b2720f79fa
Signed-off-by: Evan Wang <xswang@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/40473
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 arch/arm64/boot/dts/marvell/armada-7020-amc.dts    |    3 +++
 arch/arm64/boot/dts/marvell/armada-7040-db-B.dts   |    3 +++
 arch/arm64/boot/dts/marvell/armada-7040-db-C.dts   |    6 ++++++
 arch/arm64/boot/dts/marvell/armada-7040-db-D.dts   |    5 +++++
 arch/arm64/boot/dts/marvell/armada-7040-db-E.dts   |    3 +++
 .../arm64/boot/dts/marvell/armada-7040-db-nand.dts |    6 ++++++
 arch/arm64/boot/dts/marvell/armada-7040-db.dts     |   13 +++++++++++++
 arch/arm64/boot/dts/marvell/armada-7040-pcac.dts   |    5 ++++-
 arch/arm64/boot/dts/marvell/armada-7040-pd.dts     |    6 ++++++
 arch/arm64/boot/dts/marvell/armada-8040-db-B.dts   |    3 +++
 arch/arm64/boot/dts/marvell/armada-8040-db-C.dts   |    3 +++
 arch/arm64/boot/dts/marvell/armada-8040-db-D.dts   |    3 +++
 arch/arm64/boot/dts/marvell/armada-8040-db-E.dts   |    3 +++
 arch/arm64/boot/dts/marvell/armada-8040-db.dts     |    7 +++++++
 arch/arm64/boot/dts/marvell/armada-8040-mcbin.dts  |    8 ++++++++
 arch/arm64/boot/dts/marvell/armada-8040-ocp.dts    |    3 +++
 16 files changed, 79 insertions(+), 1 deletion(-)

diff --git a/arch/arm64/boot/dts/marvell/armada-7020-amc.dts b/arch/arm64/boot/dts/marvell/armada-7020-amc.dts
index 9ed5fa2..709400d 100644
--- a/arch/arm64/boot/dts/marvell/armada-7020-amc.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7020-amc.dts
@@ -109,6 +109,9 @@
 			};
 
 			usb3h0: usb3@500000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db-B.dts b/arch/arm64/boot/dts/marvell/armada-7040-db-B.dts
index d35b835..5b71994 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db-B.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db-B.dts
@@ -104,6 +104,9 @@
 				status = "disabled";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			u3d@520000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db-C.dts b/arch/arm64/boot/dts/marvell/armada-7040-db-C.dts
index 6a28d20..dfa6ea6 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db-C.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db-C.dts
@@ -103,9 +103,15 @@
 				};
 			};
 			usb3h0: usb3@500000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			u3d@520000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db-D.dts b/arch/arm64/boot/dts/marvell/armada-7040-db-D.dts
index 2355161..60d77d6 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db-D.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db-D.dts
@@ -113,10 +113,15 @@
 				status = "disabled";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			u3d@520000 {
 				vbus-gpio = <&expander0 3 GPIO_ACTIVE_HIGH>;
+				phys = <&comphy0 1 COMPHY_USB3D0>;
+				phy-names = "usb";
 				status = "okay";
 			};
 			udc@524100 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db-E.dts b/arch/arm64/boot/dts/marvell/armada-7040-db-E.dts
index 7e223f5..c8a7f57 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db-E.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db-E.dts
@@ -103,6 +103,9 @@
 				status = "disabled";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			u3d@520000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db-nand.dts b/arch/arm64/boot/dts/marvell/armada-7040-db-nand.dts
index 319b7f3..2afb79b 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db-nand.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db-nand.dts
@@ -98,9 +98,15 @@
 				};
 			};
 			usb3h0: usb3@500000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			u3d@520000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-db.dts b/arch/arm64/boot/dts/marvell/armada-7040-db.dts
index 2efc469..a01b3ea 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-db.dts
@@ -166,6 +166,19 @@
 					reg = <0x1000000 0x3f000000>;
 				};
 			};
+
+			usb3h0: usb3@500000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
+				status = "okay";
+			};
+			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
+				status = "okay";
+			};
 		};
 
 		pcie@0x640000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-pcac.dts b/arch/arm64/boot/dts/marvell/armada-7040-pcac.dts
index 91c6d7b..9b055e0 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-pcac.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-pcac.dts
@@ -127,8 +127,11 @@
 				};
 			};
 			usb3h0: usb3@500000 {
-				status = "okay";
 				usb-phy = <&usb3h0_phy>;
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
+				status = "okay";
 			};
 			usb3h1: usb3@510000 {
 				status = "disabled";
diff --git a/arch/arm64/boot/dts/marvell/armada-7040-pd.dts b/arch/arm64/boot/dts/marvell/armada-7040-pd.dts
index 7154484..c4ccb6c 100644
--- a/arch/arm64/boot/dts/marvell/armada-7040-pd.dts
+++ b/arch/arm64/boot/dts/marvell/armada-7040-pd.dts
@@ -149,9 +149,15 @@
 				status = "okay";
 			};
 			usb3h0: usb3@500000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 1 COMPHY_USB3H0>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			spi@700680 {
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db-B.dts b/arch/arm64/boot/dts/marvell/armada-8040-db-B.dts
index 3478e09..09beb6b 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db-B.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db-B.dts
@@ -87,6 +87,9 @@
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			sdhci@780000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db-C.dts b/arch/arm64/boot/dts/marvell/armada-8040-db-C.dts
index 56b849a..85fa1f2 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db-C.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db-C.dts
@@ -100,6 +100,9 @@
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			sdhci@780000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db-D.dts b/arch/arm64/boot/dts/marvell/armada-8040-db-D.dts
index 3016cf4..db4a036 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db-D.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db-D.dts
@@ -101,6 +101,9 @@
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			sdhci@780000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db-E.dts b/arch/arm64/boot/dts/marvell/armada-8040-db-E.dts
index f4b5592..a3dda87 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db-E.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db-E.dts
@@ -108,6 +108,9 @@
 				status = "okay";
 			};
 			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			sdhci@780000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-db.dts b/arch/arm64/boot/dts/marvell/armada-8040-db.dts
index fbcd571..dcaf188 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-db.dts
@@ -113,6 +113,13 @@
 				 * vbus-gpio = <&expander0 3 GPIO_ACTIVE_HIGH>;
 				 */
 			};
+
+			usb3h1: usb3@510000 {
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy0 4 COMPHY_USB3H1>;
+				phy-names = "usb3";
+				status = "okay";
+			};
 		};
 		pcie@0x600000 {
 			status = "okay";
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-mcbin.dts b/arch/arm64/boot/dts/marvell/armada-8040-mcbin.dts
index 9dda497..45f185d 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-mcbin.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-mcbin.dts
@@ -119,6 +119,14 @@
 					status = "okay";
 				};
 			};
+
+			usb3h0: usb3@500000 {
+				usb-phy = <&usb3h0_phy>;
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy1 2 COMPHY_USB3H0>;
+				phy-names = "usb3";
+				status = "okay";
+			};
 		};
 		pcie@0x600000 {
 			num-lanes = <4>;
diff --git a/arch/arm64/boot/dts/marvell/armada-8040-ocp.dts b/arch/arm64/boot/dts/marvell/armada-8040-ocp.dts
index 213dd39..236d7d2 100644
--- a/arch/arm64/boot/dts/marvell/armada-8040-ocp.dts
+++ b/arch/arm64/boot/dts/marvell/armada-8040-ocp.dts
@@ -143,6 +143,9 @@
 			};
 			usb3h0_1: usb3@500000 {
 				usb-phy = <&usb3h0_phy>;
+				separated-phys-for-usb2-usb3;
+				phys = <&comphy1 2 COMPHY_USB3H0>;
+				phy-names = "usb3";
 				status = "okay";
 			};
 			usb3h0_phy: usb3_phy0 {
-- 
1.7.9.5

