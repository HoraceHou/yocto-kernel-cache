From 404cd39d3019b7d5c5e51bf5c640011556492860 Mon Sep 17 00:00:00 2001
From: Ken Ma <make@marvell.com>
Date: Fri, 10 Mar 2017 23:27:26 +0800
Subject: [PATCH 0883/1345] dts: a3700: add phys' reference to usb3 node

commit  f88544c3c5f08163df4d433e0b242be707d0d9a2 from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

- Armada 3700 usb32 controller uses a utmi dedicated phy for USB 2.0
  and uses a comphy for USB 3.0, add these 2 phys' reference to its
  usb3 node.
- Set property "separated-phys-for-usb2-usb3" for Armada 3700.

Change-Id: Ia4457c59987e644b3e467fea6f2467f6789ba5df
Signed-off-by: Ken Ma <make@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/37392
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Reviewed-by: Victor Gu <xigu@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 .../boot/dts/marvell/armada-3720-community.dts     |    3 +++
 arch/arm64/boot/dts/marvell/armada-3720-db.dts     |    3 +++
 arch/arm64/boot/dts/marvell/armada-37xx.dtsi       |    1 +
 3 files changed, 7 insertions(+)

diff --git a/arch/arm64/boot/dts/marvell/armada-3720-community.dts b/arch/arm64/boot/dts/marvell/armada-3720-community.dts
index c9f5d03..b75e269 100644
--- a/arch/arm64/boot/dts/marvell/armada-3720-community.dts
+++ b/arch/arm64/boot/dts/marvell/armada-3720-community.dts
@@ -112,6 +112,9 @@
 
 			usb3@58000 {
 				status = "okay";
+				phys = <&utmi_usb32>, /* utmi usb32 dedicated phy */
+				       <&a3700_comphy 1 COMPHY_USB3>; /* usb3 comphy */
+				phy-names = "usb2", "usb3";
 			};
 
 			usb@5e000 {
diff --git a/arch/arm64/boot/dts/marvell/armada-3720-db.dts b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
index cec6d1d..c161dd3 100644
--- a/arch/arm64/boot/dts/marvell/armada-3720-db.dts
+++ b/arch/arm64/boot/dts/marvell/armada-3720-db.dts
@@ -261,6 +261,9 @@
 &usb3 {
 	status = "okay";
 	usb-phy = <&usb3_phy>;
+	phys = <&utmi_usb32>, /* utmi usb32 dedicated phy */
+       <&a3700_comphy 1 COMPHY_USB3>; /* usb3 comphy */
+	phy-names = "usb2", "usb3";
 };
 
 /* CON17 (PCIe) / CON12 (mini-PCIe) */
diff --git a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
index f995581..0d9eb46 100644
--- a/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
+++ b/arch/arm64/boot/dts/marvell/armada-37xx.dtsi
@@ -388,6 +388,7 @@
 				reg = <0x58000 0x4000>;
 				interrupts = <GIC_SPI 3 IRQ_TYPE_LEVEL_HIGH>;
 				clocks = <&sb_periph_clk 12>;
+				separated-phys-for-usb2-usb3;
 				status = "disabled";
 			};
 
-- 
1.7.9.5

