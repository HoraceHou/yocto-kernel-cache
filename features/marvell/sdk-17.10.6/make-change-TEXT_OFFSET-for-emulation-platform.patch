From fc1dda970239d654e71e8baf30465f2e9b844b93 Mon Sep 17 00:00:00 2001
From: Yehuda Yitschak <yehuday@marvell.com>
Date: Tue, 28 Jul 2015 16:37:33 +0300
Subject: [PATCH 0115/1345] make: change TEXT_OFFSET for emulation platform

commit  cca057eaa41e87ab1df2c9869dc85c8fa776cb0d from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

To avoid copying the image during booti command we change
the TEXT_OFFSET to match the load address in u-boot

Change-Id: Ibca88d99309470b5f6860a9a09d5dab2aa0a632c
Signed-off-by: Yehuda Yitschak <yehuday@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/22264
Tested-by: Star_Automation <star@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/28082
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 arch/arm64/Makefile |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/arch/arm64/Makefile b/arch/arm64/Makefile
index 44fa9fa..02ad6d9 100644
--- a/arch/arm64/Makefile
+++ b/arch/arm64/Makefile
@@ -88,8 +88,12 @@ TEXT_OFFSET := $(shell awk "BEGIN {srand(); printf \"0x%06x\n\", \
 		 int(2 * 1024 * 1024 / (2 ^ $(CONFIG_ARM64_PAGE_SHIFT)) * \
 		 rand()) * (2 ^ $(CONFIG_ARM64_PAGE_SHIFT))}")
 else
+ifeq ($(CONFIG_ARCH_MVEBU_PD), y)
+TEXT_OFFSET := 0x00180000
+else
 TEXT_OFFSET := 0x00080000
 endif
+endif
 
 # KASAN_SHADOW_OFFSET = VA_START + (1 << (VA_BITS - 3)) - (1 << 61)
 # in 32-bit arithmetic
-- 
1.7.9.5

