From 53da6369a19af6baf4202fe147980c694bbde631 Mon Sep 17 00:00:00 2001
From: Marcin Wojtas <mw@semihalf.com>
Date: Sun, 28 Aug 2016 03:43:12 +0200
Subject: [PATCH 0464/1345] pcie: armada8k: remove redundant free from error
 path

commit  5258e4f81092e3b265f3e7e5a6e64ac552158d40 from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

kzalloc() called as 'managed' function, doesn't require manual
handling for freeing resources, as it will be done automatically
on driver detach/remove (and hence probe fail).

This patch is part of patch-set which adds
mainline mvebu clock gating support [16/21].

Change-Id: I00fdfa172ed28eec47181591dea78f6afd142c49
Signed-off-by: Marcin Wojtas <mw@semihalf.com>
Signed-off-by: Igal Liberman <igall@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/32401
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Reviewed-by: Omri Itach <omrii@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/pci/host/pcie-armada8k.c |    2 --
 1 file changed, 2 deletions(-)

diff --git a/drivers/pci/host/pcie-armada8k.c b/drivers/pci/host/pcie-armada8k.c
index f3843b1..304a3b6 100644
--- a/drivers/pci/host/pcie-armada8k.c
+++ b/drivers/pci/host/pcie-armada8k.c
@@ -289,8 +289,6 @@ static int armada8k_pcie_probe(struct platform_device *pdev)
 	if (!IS_ERR(armada8k_pcie->clk))
 		clk_disable_unprepare(armada8k_pcie->clk);
 
-	devm_kfree(dev, armada8k_pcie);
-
 	return ret;
 }
 
-- 
1.7.9.5

