From 1aaa28d7ca26e1968b5705ed6263e7fe3cb80afe Mon Sep 17 00:00:00 2001
From: Ofer Heifetz <oferh@marvell.com>
Date: Sun, 14 Jan 2018 11:04:58 +0200
Subject: [PATCH 1288/1345] crypto: inside-secure: use digest size instead of
 explicit size

commit  dc030b449044c3df5523fd4c28fcdff73c8ca081 from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

Change-Id: I53a29e9ddefef8c413afa4c0ed3514e38ccce8b3
Signed-off-by: Ofer Heifetz <oferh@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/48932
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/51669
Tested-by: Hanna Hawa <hannah@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/crypto/inside-secure/hash.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/crypto/inside-secure/hash.c b/drivers/crypto/inside-secure/hash.c
index 8f0a9a2..94872d7 100644
--- a/drivers/crypto/inside-secure/hash.c
+++ b/drivers/crypto/inside-secure/hash.c
@@ -135,7 +135,8 @@ static void safexcel_context_control(struct safexcel_ahash_ctx *ctx,
 		cdesc->control_data.control0 |= CONTEXT_CONTROL_SIZE(10);
 
 		memcpy(ctx->base.ctxr->data, ctx->ipad, digestsize);
-		memcpy(ctx->base.ctxr->data + 5, ctx->opad, digestsize);
+		memcpy(ctx->base.ctxr->data + digestsize / sizeof(u32),
+		       ctx->opad, digestsize);
 	}
 }
 
-- 
1.7.9.5

