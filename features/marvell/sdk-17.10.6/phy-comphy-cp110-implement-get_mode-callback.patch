From 8e82fd989973cd2973bda685df9912045e364a1f Mon Sep 17 00:00:00 2001
From: Igal Liberman <igall@marvell.com>
Date: Sun, 13 Nov 2016 16:04:20 +0200
Subject: [PATCH 0573/1345] phy: comphy: cp110: implement get_mode callback

commit  0e3e586ab57a08e936e86428733445fa7720b43b from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

Change-Id: I67ebcd218afcfa3c28133788fcb2c3aaff101192
Signed-off-by: Igal Liberman <igall@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/33724
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Omri Itach <omrii@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/phy/phy-mvebu-comphy.c |   16 ++++++++++++++++
 1 file changed, 16 insertions(+)

diff --git a/drivers/phy/phy-mvebu-comphy.c b/drivers/phy/phy-mvebu-comphy.c
index a339b70..1fe5860 100644
--- a/drivers/phy/phy-mvebu-comphy.c
+++ b/drivers/phy/phy-mvebu-comphy.c
@@ -696,10 +696,26 @@ static int mvebu_comphy_set_mode(struct phy *phy, enum phy_mode mode)
 	return 0;
 }
 
+static enum phy_mode mvebu_comphy_get_mode(struct phy *phy)
+{
+	struct mvebu_comphy *comphy = phy_get_drvdata(phy);
+	struct mvebu_comphy_priv *priv = to_mvebu_comphy_priv(comphy);
+	int mode;
+
+	dev_dbg(priv->dev, "%s: Enter\n", __func__);
+
+	mode = priv->lanes[comphy->index].mode;
+
+	dev_dbg(priv->dev, "%s: Exit\n", __func__);
+
+	return (enum phy_mode)mode;
+}
+
 static struct phy_ops mvebu_comphy_ops = {
 	.power_on	= mvebu_comphy_power_on,
 	.power_off	= mvebu_comphy_power_off,
 	.set_mode	= mvebu_comphy_set_mode,
+	.get_mode	= mvebu_comphy_get_mode,
 	.owner		= THIS_MODULE,
 };
 
-- 
1.7.9.5

