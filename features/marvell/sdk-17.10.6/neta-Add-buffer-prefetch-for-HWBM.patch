From e9592e5e916eb1281f41f62fa6edfad3e1d9dfea Mon Sep 17 00:00:00 2001
From: Dmitri Epshtein <dima@marvell.com>
Date: Sun, 23 Jul 2017 17:26:50 +0300
Subject: [PATCH 1203/1345] neta: Add buffer prefetch for HWBM

commit  7fc3c6f828c24e63b5357b67af7e40c1ae85295d from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

prefetch first cache line of packet data (header)

Change-Id: Iab16acda347eb23697c3c4d475cb5ae6ecb2942d
Signed-off-by: Dmitri Epshtein <dima@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/42049
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Neta Zur Hershkovits <neta@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/net/ethernet/marvell/mvneta.c |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/net/ethernet/marvell/mvneta.c b/drivers/net/ethernet/marvell/mvneta.c
index dcbfc34..62b2fb3 100644
--- a/drivers/net/ethernet/marvell/mvneta.c
+++ b/drivers/net/ethernet/marvell/mvneta.c
@@ -2320,6 +2320,9 @@ static int mvneta_rx_hwbm(struct mvneta_port *pp, int rx_todo,
 			continue;
 		}
 
+		/* Prefetch header */
+		prefetch(data);
+
 		if (rx_bytes <= rx_copybreak) {
 			/* better copy a small frame and not unmap the DMA region */
 			skb = napi_alloc_skb(napi, rx_bytes);
-- 
1.7.9.5

