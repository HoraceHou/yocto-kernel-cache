From 32952ad2ebc7c54b32a612a1c677afcbb2dbb052 Mon Sep 17 00:00:00 2001
From: Stefan Chulski <stefanc@marvell.com>
Date: Sun, 3 Jul 2016 11:29:20 +0300
Subject: [PATCH 0324/1345] net: mvpp2x: ethtool print advertise mode support

commit  0709170d413a0db927cc47d337aa423e020e97b3 from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

Change-Id: I554165a47816dbf64b23ee9b84e484e935936453
Signed-off-by: Stefan Chulski <stefanc@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/30897
Reviewed-by: Yuval Caduri <cyuval@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 .../net/ethernet/marvell/mvpp2x/mv_pp2x_ethtool.c  |    8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_ethtool.c b/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_ethtool.c
index e08d87a..3df67de 100644
--- a/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_ethtool.c
+++ b/drivers/net/ethernet/marvell/mvpp2x/mv_pp2x_ethtool.c
@@ -285,13 +285,19 @@ static int mv_pp2x_ethtool_get_settings(struct net_device *dev,
 				SUPPORTED_100baseT_Full |
 				SUPPORTED_Autoneg | SUPPORTED_TP |
 				SUPPORTED_MII |	SUPPORTED_1000baseT_Full);
+			cmd->advertising = (ADVERTISED_10baseT_Half |
+				ADVERTISED_10baseT_Full |
+				ADVERTISED_100baseT_Half |
+				ADVERTISED_100baseT_Full |
+				ADVERTISED_1000baseT_Full |
+				ADVERTISED_Autoneg | ADVERTISED_TP |
+				ADVERTISED_MII);
 			cmd->transceiver = XCVR_INTERNAL;
 			cmd->port = PORT_MII;
 
 			/* check if speed and duplex are AN */
 			if (mv_gop110_port_autoneg_status(&port->priv->hw.gop,
 					   &port->mac_data)) {
-				cmd->lp_advertising = cmd->advertising = 0;
 				cmd->autoneg = AUTONEG_ENABLE;
 			} else {
 				cmd->autoneg = AUTONEG_DISABLE;
-- 
1.7.9.5

