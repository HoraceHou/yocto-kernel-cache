From c29f23691d592078f503ae533811806f2511d4cc Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Tue, 4 Apr 2017 17:47:30 +0300
Subject: [PATCH 0962/1345] fix: clk: ap806: update supported frequency modes

commit  965d69eae60668d0f5b3bfdcaeab81fcd94e152c from
https://github.com/MarvellEmbeddedProcessors/linux-marvell.git

Align all frequency mode entries with most updated
SoC specification, including HCLK settings.

Supported frequency modes and their Sample at Reset value:
0x0  :	CPU@2000Mhz, DDR@1200Mhz, RCLK@1200Mhz
0x1  :	CPU@2000Mhz, DDR@1050Mhz, RCLK@1050Mhz
0x4  :	CPU@1600Mhz, DDR@800 Mhz, RCLK@800Mhz
0x6  :	CPU@1800Mhz, DDR@1200Mhz, RCLK@1200Mhz
0x7  :	CPU@1800Mhz, DDR@1050Mhz, RCLK@1050Mhz
0x0d :  CPU@1600Mhz, DDR@1050Mhz, RCLK@1050Mhz
0x13 :  CPU@1000Mhz, DDR@650Mhz,  RCLK@650Mhz
0x14 :  CPU@1300Mhz, DDR@800Mhz,  RCLK@800Mhz
0x17 :  CPU@1300Mhz, DDR@650Mhz,  RCLK@650Mhz
0x19 :  CPU@1200Mhz, DDR@800Mhz,  RCLK@800Mhz
0x1a :  CPU@1400Mhz, DDR@800Mhz,  RCLK@800Mhz
0x1b :  CPU@600Mhz,  DDR@800Mhz,  RCLK@800Mhz
0x1c :  CPU@800Mhz,  DDR@800Mhz,  RCLK@800Mhz
0x1d :  CPU@1000Mhz, DDR@800Mhz,  RCLK@800Mhz

Change-Id: I55d080373753797a4e7dabb44c6cc3a3760967b6
Signed-off-by: Omri Itach <omrii@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/38462
Tested-by: iSoC Platform CI <ykjenk@marvell.com>
Reviewed-by: Hanna Hawa <hannah@marvell.com>
Signed-off-by: Meng Li <Meng.Li@windriver.com>
---
 drivers/clk/mvebu/ap806-system-controller.c |   40 +++++++++------------------
 1 file changed, 13 insertions(+), 27 deletions(-)

diff --git a/drivers/clk/mvebu/ap806-system-controller.c b/drivers/clk/mvebu/ap806-system-controller.c
index ee82a9b..b586515 100644
--- a/drivers/clk/mvebu/ap806-system-controller.c
+++ b/drivers/clk/mvebu/ap806-system-controller.c
@@ -94,50 +94,36 @@ static int ap806_syscon_clk_probe(struct platform_device *pdev)
 		** baudrate of the UART
 		*/
 		cpuclk_freq = 0;
-		dev_err(&pdev->dev, "invalid SAR value\n");
+		dev_err(&pdev->dev, "invalid Sample at Reset value\n");
 	}
 
-	/* Get DCLK frequency */
+	/* Get DCLK frequency (DCLK = 0.5*DDR_CLK) */
 	switch (freq_mode) {
 	case 0x0:
+	case 0x6:
 		dclk_freq = 600;
 		break;
 	case 0x1:
-		dclk_freq = 525;
-		break;
-	case 0x4:
-	case 0x10:
-	case 0x14:
-	case 0x19 ... 0x1D:
-		dclk_freq = 400;
-		break;
-	case 0xC:
-		dclk_freq = 600;
-		break;
+	case 0x7:
 	case 0xD:
-	case 0x16:
 		dclk_freq = 525;
 		break;
-	case 0xB:
-	case 0xE:
-	case 0xF:
-		dclk_freq = 450;
-		break;
-	case 0x12:
 	case 0x13:
 	case 0x17:
 		dclk_freq = 325;
 		break;
-	case 0x11:
-	case 0x15:
-		dclk_freq = 800;
-		break;
-	case 0x18:
-		dclk_freq = 650;
+	case 0x4:
+	case 0x14:
+	case 0x19:
+	case 0x1A:
+	case 0x1B:
+	case 0x1C:
+	case 0x1D:
+		dclk_freq = 400;
 		break;
 	default:
 		dclk_freq = 0;
-		pr_err("invalid SAR value\n");
+		pr_err("invalid Sample at Reset value\n");
 	}
 
 	/* Convert to hertz */
-- 
1.7.9.5

