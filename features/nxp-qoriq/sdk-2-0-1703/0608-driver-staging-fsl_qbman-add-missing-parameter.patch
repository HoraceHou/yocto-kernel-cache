From 9e4d276943dd2cfe48db3da236963092a837bbe8 Mon Sep 17 00:00:00 2001
From: Xulin Sun <xulin.sun@windriver.com>
Date: Mon, 28 May 2018 15:19:06 +0800
Subject: [PATCH 608/666] driver: staging: fsl_qbman: add missing parameter

Calling the function do_munmap() loses one parameter, here add it.

Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/staging/fsl_qbman/fsl_usdpaa.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
 mode change 100644 => 100755 drivers/staging/fsl_qbman/fsl_usdpaa.c

diff --git a/drivers/staging/fsl_qbman/fsl_usdpaa.c b/drivers/staging/fsl_qbman/fsl_usdpaa.c
old mode 100644
new mode 100755
index 37ba67d..e2d087a
--- a/drivers/staging/fsl_qbman/fsl_usdpaa.c
+++ b/drivers/staging/fsl_qbman/fsl_usdpaa.c
@@ -1135,7 +1135,7 @@ static long ioctl_dma_map(struct file *fp, struct ctx *ctx,
 					 : PROT_WRITE),
 					MAP_SHARED,
 					start_frag->pfn_base,
-					&populate);
+					&populate, NULL);
 		up_write(&current->mm->mmap_sem);
 		if (longret & ~PAGE_MASK) {
 			ret = (int)longret;
@@ -1214,7 +1214,7 @@ static long ioctl_dma_unmap(struct ctx *ctx, void __user *arg)
 
 	base = vma->vm_start;
 	sz = vma->vm_end - vma->vm_start;
-	do_munmap(current->mm, base, sz);
+	do_munmap(current->mm, base, sz, NULL);
 	ret = 0;
  out:
 	up_write(&current->mm->mmap_sem);
@@ -1320,7 +1320,7 @@ static int portal_mmap(struct file *fp, struct resource *res, void **ptr)
 		return -EINVAL;
 	longret = do_mmap_pgoff(fp, PAGE_SIZE, (unsigned long)len,
 				PROT_READ | PROT_WRITE, MAP_SHARED,
-				res->start >> PAGE_SHIFT, &populate);
+				res->start >> PAGE_SHIFT, &populate, NULL);
 	up_write(&current->mm->mmap_sem);
 
 	if (longret & ~PAGE_MASK)
@@ -1333,7 +1333,7 @@ static int portal_mmap(struct file *fp, struct resource *res, void **ptr)
 static void portal_munmap(struct resource *res, void  *ptr)
 {
 	down_write(&current->mm->mmap_sem);
-	do_munmap(current->mm, (unsigned long)ptr, resource_size(res));
+	do_munmap(current->mm, (unsigned long)ptr, resource_size(res), NULL);
 	up_write(&current->mm->mmap_sem);
 }
 
-- 
2.7.4

